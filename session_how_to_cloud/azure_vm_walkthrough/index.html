
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>Exercise: Creating and Connecting to a Virtual Machine (VM) for both Windows and Linux - MSU Cloud Fellowship</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercise-creating-and-connecting-to-a-virtual-machine-vm-for-both-windows-and-linux" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MSU Cloud Fellowship" class="md-header__button md-logo" aria-label="MSU Cloud Fellowship" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MSU Cloud Fellowship
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exercise: Creating and Connecting to a Virtual Machine (VM) for both Windows and Linux
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MSU Cloud Fellowship" class="md-nav__button md-logo" aria-label="MSU Cloud Fellowship" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    MSU Cloud Fellowship
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        Contact
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Sessions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Sessions" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Sessions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../session_introduction/" class="md-nav__link">
        1. Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        2. How does the cloud work?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../session_cloud_storage/" class="md-nav__link">
        3. Cloud Storage
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../session_moving_data/" class="md-nav__link">
        4. Moving Data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../session_bigdata/" class="md-nav__link">
        5. Big Data and the cloud
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../session_datasystems/" class="md-nav__link">
        6. Cloud Data Systems
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../session_serverless/" class="md-nav__link">
        7. Serverless, Containers, and FaaS
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../references/" class="md-nav__link">
        References
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cloud_glossary/" class="md-nav__link">
        Cloud Glossary
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about" class="md-nav__link">
    About
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements-for-both-activities" class="md-nav__link">
    Requirements for both activities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-windows-virtual-machine" class="md-nav__link">
    Creating a Windows Virtual Machine
  </a>
  
    <nav class="md-nav" aria-label="Creating a Windows Virtual Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements-for-windows-vms" class="md-nav__link">
    Requirements for Windows VMs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-selecting-the-resource-template" class="md-nav__link">
    1. Selecting the Resource Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-select-the-pre-set-configuration" class="md-nav__link">
    2. select the pre-set configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-the-vm-using-the-azure-portal" class="md-nav__link">
    3. Configure the VM using the Azure Portal
  </a>
  
    <nav class="md-nav" aria-label="3. Configure the VM using the Azure Portal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disks-and-other-settings" class="md-nav__link">
    Disks and Other Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags" class="md-nav__link">
    Tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-and-create" class="md-nav__link">
    Review and Create
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-creating-a-linux-virtual-machine" class="md-nav__link">
    Optional:  Creating a Linux Virtual Machine
  </a>
  
    <nav class="md-nav" aria-label="Optional:  Creating a Linux Virtual Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-linux-virtual-machine" class="md-nav__link">
    Creating a Linux Virtual Machine
  </a>
  
    <nav class="md-nav" aria-label="Creating a Linux Virtual Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-selecting-the-resource-template_1" class="md-nav__link">
    1. Selecting the Resource Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-select-the-pre-set-configuration_1" class="md-nav__link">
    2. select the pre-set configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-the-vm-using-the-azure-portal_1" class="md-nav__link">
    3. Configure the VM using the Azure Portal
  </a>
  
    <nav class="md-nav" aria-label="3. Configure the VM using the Azure Portal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basics_1" class="md-nav__link">
    Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disks-and-other-settings_1" class="md-nav__link">
    Disks and Other Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags_1" class="md-nav__link">
    Tags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-and-create_1" class="md-nav__link">
    Review and Create
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viewing-vm-resources-in-your-resource-group-windows-and-linux" class="md-nav__link">
    Viewing VM Resources in your Resource group (Windows and Linux)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-vm-resource-page" class="md-nav__link">
    The VM Resource Page
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connecting" class="md-nav__link">
    Connecting
  </a>
  
    <nav class="md-nav" aria-label="Connecting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connecting-to-a-windows-vm-using-remote-desktop-protocol-rdp-client" class="md-nav__link">
    Connecting to a Windows VM using Remote Desktop Protocol (RDP) client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connecting-to-a-linux-vm-using-ssh" class="md-nav__link">
    Connecting to a Linux VM using SSH
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-and-stopping-the-vm-both-windows-and-linux" class="md-nav__link">
    Starting and Stopping the VM (both Windows and Linux)
  </a>
  
    <nav class="md-nav" aria-label="Starting and Stopping the VM (both Windows and Linux)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stopping-deallocating-the-vm-with-the-portal" class="md-nav__link">
    Stopping (deallocating) the VM with the Portal:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-the-resources-both-windows-and-linux" class="md-nav__link">
    Deleting the Resources (both Windows and Linux)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-refereences" class="md-nav__link">
    More Refereences
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="exercise-creating-and-connecting-to-a-virtual-machine-vm-for-both-windows-and-linux">Exercise: Creating and Connecting to a Virtual Machine (VM) for both Windows and Linux</h1>
<p><a href="https://mediaspace.msu.edu/media/Creating+a+Windows+Virtual+Machine+with+the+Azure+Portal/1_j3o4gsvf"><img alt="Link to Video for this Excercise" src="../vm_activity/CF21_creating%20windows%20vm%20video%20link.png" /></a> </p>
<p><em>Link to Video for the <b>Windows</b> version of exercise.  On mediaspace.msu.edu which requires a log-in</em></p>
<h2 id="about">About</h2>
<p>This is an exercise and introduction to creating Virtual Machines (VMs) and related resources using the Azure Portal.  </p>
<p>There are two nearly identical activities, and you only need complete one of them:  </p>
<ol>
<li>creating a Windows virtual machine and connecting with a graphic interface (GUI), namely Remote Desktop (rdp) to demonstrate how you may use full graphic software (like Rstudio, Matlab, etc) on a cloud computer</li>
<li>creating a Linux Virtual machine and connection with the command line to demonstrate how you may use a terminal interface (or scripting) on a cloud computer.   </li>
</ol>
<p>We will use a pre-configured virtual machine with software already installed for both versions.  When creating a VM you can use an Azure template and there are many of these.  The Data Science Virtual Machine (DSVM) from Azure has R, Python and many data science and statistical libraries available.   For more information about the Azure DSVM see <a href="https://azure.microsoft.com/en-us/services/virtual-machines/data-science-virtual-machines/">https://azure.microsoft.com/en-us/services/virtual-machines/data-science-virtual-machines/</a>   and for the list of tools installed, see <a href="https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/tools-included">https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/tools-included</a>  Azure has a new product called "Azure Machine Learning" that we may cover in a future session. </p>
<h2 id="requirements-for-both-activities">Requirements for both activities</h2>
<p>You need an Azure account with an active subscription, and a resource group of your own to work in.   Fellows have these things provided.  </p>
<p>This exercise assumes you understand how to use the Azure Portal, which is covered in the <a href="../azure_portal_walkthrough/">Azure Portal Walkthrough</a>.  In addition it's helpful to know what a virtual machine is but it's not crucial to complete the exercise.  For more information on VMs see the <a href="../msu-cloud-fellowship21-session2.pdf">slides from session 2</a> and readings from the <a href="../#readings">"Virtual Machine Background"</a> section</p>
<p>It's helpful to have basic understanding of the <a href="cloud_glossary/#client-server">"Client-Server"</a> model of computing as the VM we create will be running servers (remote desktop server for Windows, and ssh command line server for Linux)</p>
<hr>

<h2 id="creating-a-windows-virtual-machine">Creating a <strong>Windows</strong> Virtual Machine</h2>
<p>This section is based on Windows.  For an equivalant exercise based on Linux, scroll down.  If at any point, or if you are exploring, you can't seem to get the configuration correct (or there is a validation error you can't fix), starting over will not create any resources or incur charges.   Go back to step 1 below. </p>
<h3 id="requirements-for-windows-vms">Requirements for Windows VMs</h3>
<p>To connect to a Windows VM desktop, it's recommend you use the Microsoft Remote Desktop client.  </p>
<ul>
<li>MacOS : install the Microsoft Remote Desktop Client, only available on the App Store: <a href="https://apps.apple.com/app/microsoft-remote-desktop/id1295203466?mt=12">https://apps.apple.com/app/microsoft-remote-desktop/id1295203466?mt=12</a></li>
<li>Linux users install <a href="http://xrdp.org/">http://xrdp.org/</a></li>
<li>Windows Users ensure you have the client : In the search box on the taskbar, type Remote Desktop, and then select Remote Desktop Connection.</li>
</ul>
<h3 id="1-selecting-the-resource-template">1. Selecting the Resource Template</h3>
<p>In the <a href="https://portal.azure.com">Azure Portal</a> open the top left menu, and click "+ Create a resource" option (the first option)</p>
<p>In the create resource search box, type "data science virtual machine"</p>
<p>In the options select <strong>Data Science Virtual Machine - Windows 2019 </strong></p>
<p>The "Plans" section has a description of the template if you would like to know more. </p>
<p>Click the "<strong>start with a pre-set configuration</strong>" option. </p>
<h3 id="2-select-the-pre-set-configuration">2. select the pre-set configuration</h3>
<p>These configurations help to select your VM size based on your activity.  We will use the default options and click <strong>"Continue to create a VM"</strong> </p>
<p>The options do not affect the outcome of the exercise so at this step explore each option</p>
<p>Click "<strong>Continue to create a VM</strong>"</p>
<h3 id="3-configure-the-vm-using-the-azure-portal">3. Configure the VM using the Azure Portal</h3>
<p>The resource creation forms work as described in the Azure Portal but since we used a pre-set configuration some of the values will be completed. </p>
<h5 id="basics">Basics</h5>
<ol>
<li>
<p>The <strong>Subscription</strong> should be "Cloud Fellowship" and
<strong>resource group</strong> should be your CF resource group (with your netid).  As we create additional resource groups for this </p>
</li>
<li>
<p><strong>Virtual machine name</strong>  Name: CF21-netid-dsvmtest
   One option is to combine the project (e.g. the fellowship), your net id, and some description of what you are doing.   In the name above, replace "netid" with your own MSU netid.   </p>
</li>
</ol>
<p>Note that different resources have different naming restrictions.  For example VMs the rules are "can be almost anything, but Azure resource names cannot contain special characters \/""[]:|&lt;&gt;+=;,?*@&amp;, whitespace, or begin with '_' or end with '.' or '-' "</p>
<p>Note if you have an existing VM with this name, add a number 2 or other suffix.  We will delete this VM and create something more suitable in the future. 
1. <strong>Region</strong>  Select "(US) North Central US"
1. <strong>Availability Options</strong> select "No infrastructure Redundancy required"<br />
   this option is for critical infrastructure that needs to withstand a serious outage (e.g. if a hurricane affects a data center).<br />
   You may also see an "availability zone" option appear (perhaps with an error message <em>"The value must not be empty"</em>).  Selecting ""No infrastructure Redundancy required" in the availability zone will remove the "availability zone" field and error message. 
1. <strong>Image</strong> should be "Data Science Virtual Machine - windows..."   if this is change you may 
1. <strong>Azure Spot Instance</strong>  leave unchecked. <br />
1. <strong>Size</strong>   You can leave the size that is currently selected, which is based on the pre-set configuration from the previous step. 
   This is how you select the specifications for <a href="../cloud_glossary/#cpu">CPU</a> and memory.  The size you for this exercise doesn't matter for the outcome, but it will show prices which may be interesting.  If you click this drop-down menu you may see some other sizes and prices.  The Monthly price assumes 24 hour/day operation.  Your price to experiment will often be less than $1.00<br />
1. <strong>Administrator Account</strong>
   Just like you need to log-in to your own computer, you must create a user account for the VM.   Select a User name and account that you will easily remember, because you will need it to log-in to the new VM. 
    * username : use any user name you will easily remember, perhaps your netid
    * password : something you can remember, but is complex to be secure.  Do <strong>not</strong> use your MSU password or any other passwords you use
1. <strong>Licensing</strong>  Unlike Linux, Windows requires a license, and this option are for organization with an arrangement with Azure.   Leave this box unchecked and Azure will add the extra charges (a few cents per hour) for the use of Windows.    </p>
<h5 id="disks-and-other-settings">Disks and Other Settings</h5>
<p>For this exercise we'll be using the default values for almost all the pages except for <strong>Basics</strong> page.    However you are encouraged to look through these options to see what is involved in creating a virtual machine.  The <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/">Azure VM documentation</a> covers many of them.   For example a VM requires several networking components.   The good news is that Azure will name and create these for you, which will see.  </p>
<h5 id="tags">Tags</h5>
<p>Using tags will be essential for identifying which components go to which VM. This is the metadata associated with these resources.  I suggest using a tag like "activity" to indicate which of our activities was used to create these resources.   </p>
<ol>
<li>Click "tags" in the top row of options (just before 'review and create')</li>
<li>In the first row, For <strong>Name</strong>, type <code>activity</code> and for the <strong>Value</strong> type  <code>session2</code></li>
<li>click "review and create" </li>
</ol>
<h5 id="review-and-create">Review and Create</h5>
<p>If there are errors the form name will have a red dot next to it.  Go back to that form and see what may be the issue. </p>
<p>If the Validation passed, it will display the approximate hourly cost to use this VM.  Mine says <code>0.1920 USD/hr</code></p>
<p>Click "Create" and the deployment will start.  It will take at most 15 minutes.  </p>
<p>You should kkip down the the <strong>Viewing VM Resources</strong> section below/ </p>
<hr>

<h2 id="optional-creating-a-linux-virtual-machine">Optional:  Creating a <strong>Linux</strong> Virtual Machine</h2>
<p>This sections is nearly identical to the section above with Windows, but uses Ubuntu Linux, and does not use a graphical interface (although with some work this is possible). </p>
<h4 id="requirements">Requirements</h4>
<p>To connect to Linux you need an terminal or command line interface with an <code>ssh</code> client software.  If you have used the MSU HPC, this is the same method for connection.  </p>
<ul>
<li>On Mac, the Terminal.app has ssh</li>
<li>On Modern version of Windows, the cmd.exe command prompt has an <code>ssh</code> command built in but there are other programs </li>
<li>Linux desktop/laptops come with an ssh client</li>
</ul>
<h3 id="creating-a-linux-virtual-machine">Creating a Linux Virtual Machine</h3>
<p>If at any point, or if you are exploring, you can't seem to get the configuration correct (or there is a validation error you can't fix), starting over will not create any resources or incur charges.   Go back to step 1 below. </p>
<h4 id="1-selecting-the-resource-template_1">1. Selecting the Resource Template</h4>
<p>In the <a href="https://portal.azure.com">Azure Portal</a> open the top left menu, and click "+ Create a resource" option (the first option)</p>
<p>In the create resource search box, type "data science virtual machine"</p>
<p>In the options select <strong>Data Science Virtual Machine - Ubuntu </strong></p>
<p>The "Plans" section has a description of the template if you would like to know more. </p>
<p>Click the "<strong>start with a pre-set configuration</strong>" option. </p>
<h4 id="2-select-the-pre-set-configuration_1">2. select the pre-set configuration</h4>
<p>These configurations help to select your VM size based on your activity.  We will use the default options and click <strong>"Continue to create a VM"</strong> </p>
<p>The options do not affect the outcome of the exercise so at this step explore each option</p>
<p>Click "<strong>Continue to create a VM</strong>"</p>
<h4 id="3-configure-the-vm-using-the-azure-portal_1">3. Configure the VM using the Azure Portal</h4>
<p>The resource creation forms work as described in the Azure Portal but since we used a pre-set configuration some of the values will be completed. </p>
<h5 id="basics_1">Basics</h5>
<ol>
<li>
<p>The <strong>Subscription</strong> should be "Cloud Fellowship" and
<strong>resource group</strong> should be your CF resource group (with your netid).  As we create additional resource groups for this </p>
</li>
<li>
<p><strong>Virtual machine name</strong>  Name: CF21-netid-linuxdsvmtest
   One option is to combine the project (e.g. the fellowship), your net id, and some description of what you are doing.   In the name above, replace "netid" with your own MSU netid.   </p>
</li>
</ol>
<p>Note that different resources have different naming restrictions.  For example VMs the rules are "can be almost anything, but Azure resource names cannot contain special characters \/""[]:|&lt;&gt;+=;,?*@&amp;, whitespace, or begin with '_' or end with '.' or '-' "</p>
<p>Note if you have an existing VM with this name, add a number 2 or other suffix.  We will delete this VM and create something more suitable in the future. 
1. <strong>Region</strong>  Select "(US) North Central US"
1. <strong>Availability Options</strong> select "No infrastructure Redundancy required"<br />
   this option is for critical infrastructure that needs to withstand a serious outage (e.g. if a hurricane affects a data center).<br />
   You may also see an "availability zone" option appear (perhaps with an error message <em>"The value must not be empty"</em>).  Selecting ""No infrastructure Redundancy required" in the availability zone will remove the "availability zone" field and error message. 
1. <strong>Image</strong> should be "Data Science Virtual Machine - Unbuntu.."   if this is changed you may have to select it again from the list. 
1. <strong>Azure Spot Instance</strong>  leave unchecked. <br />
1. <strong>Size</strong>   You can leave the size that is currently selected, which is based on the pre-set configuration from the previous step.   <br>
   This is how you select the specifications for <a href="../cloud_glossary/#cpu">CPU</a> and memory.  The size you for this exercise doesn't matter for the outcome, but it will show prices which may be interesting.  If you click this drop-down menu you may see some other sizes and prices.  The Monthly price assumes 24 hour/day operation.  Your price to experiment will often be less than $1.00<br />
1. <strong>Administrator Account</strong>
   Just like you need to log-in to your own computer, you must create a user account for the VM. <br />
   1. <strong>Authentication Type</strong>  For the purpose of this exercise, select "password"
   If you are very familiar with ssh keys, this is the recommended method.  You will be asked to download a key and use that key in your ssh command.  The key is only available for download when you create this vm and if you lose it you can't connect.   We can definitely cover how to use ssh keys as this is the preferred method for connecting. </p>
<ol>
<li>
<p><strong>UserName</strong> Select a User name and account that you will easily remember, because you will need it to log-in to the new VM. </p>
</li>
<li>
<p><strong>password</strong> : something you can remember, but is complex to be secure.  Do <strong>not</strong> use your MSU password or any other passwords you use</p>
</li>
</ol>
<h5 id="disks-and-other-settings_1">Disks and Other Settings</h5>
<p>For this exercise we'll be using the default values for almost all the pages except for <strong>Basics</strong> page.    However you are encouraged to look through these options to see what is involved in creating a virtual machine.  The <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/">Azure VM documentation</a> covers many of them.   For example a VM requires several networking components.   The good news is that Azure will name and create these for you, which will see.  </p>
<h5 id="tags_1">Tags</h5>
<p>Using tags will be essential for identifying which components go to which VM. This is the metadata associated with these resources.  I suggest using a tag like "activity" to indicate which of our activities was used to create these resources.   </p>
<ol>
<li>Click "tags" in the top row of options (just before 'review and create')</li>
<li>In the first row, For <strong>Name</strong>, type <code>activity</code> and for the <strong>Value</strong> type  <code>session2</code></li>
<li>click "review and create" </li>
</ol>
<h5 id="review-and-create_1">Review and Create</h5>
<p>If there are errors the form name will have a red dot next to it.  Go back to that form and see what may be the issue. </p>
<p>If the Validation passed, it will display the approximate hourly cost to use this Linux VM.  Mine says <code>0.1000 USD/hr</code></p>
<p>Click "Create" and the deployment will start.  It will take at most 15 minutes.  </p>
<p>Linux Users continue to the next section</p>
<hr>

<h2 id="viewing-vm-resources-in-your-resource-group-windows-and-linux"><strong>Viewing VM Resources in your Resource group (Windows and Linux)</strong></h2>
<p><em>While the deployment is in progress you may explore the operation details or click any of the resources that have been created.</em>   </p>
<ol>
<li>Open your resource group in the portal:  <ol>
<li>click the portal menu on the top left, and select "resource groups"</li>
</ol>
</li>
<li>From the list, select your CF21 group. </li>
<li>When the deployment is finished, you should see several new resources <ul>
<li>They will have the same name prefix "CF21netid-dsvm" but may have a suffix indicating the kind of resource (e.g. CF21-netid-dsvm1-ip </li>
<li>The second column is the "type" which helps identify what they are</li>
</ul>
</li>
</ol>
<p><a href="../vm_activity/vm_activity_screenshot_resource_group_list.jpg" target="_blank"><img alt="Resource Group List" src="../vm_activity/vm_activity_screenshot_resource_group_list.jpg" /></a>
<em>click for a large view in a new tab/window</em></p>
<ol>
<li>Select the item with type "virtual machine" and click on the name to open its resource page (for example, cf21-billspat-dsvmtest item in the screenshot above)</li>
</ol>
<h2 id="the-vm-resource-page">The VM Resource Page</h2>
<p>To see the details for your virtual machine, click the VM in your resource group if you haven't already. </p>
<p><a href="../vm_activity/vm_activity_screenshot_vm_resource_portal_page_no_highlights.png" target="_blank"><img alt="Azure Portal view of an example VM" src="../vm_activity/vm_activity_screenshot_vm_resource_portal_page_no_highlights.png" /></a>
<em>click for larger view</em></p>
<p>There are many details here but some immediate things to notice: </p>
<ul>
<li>in the top row are buttons to connect, start, restart and stop the vvm.   </li>
<li>in the top, "essentials" section the  "status" should be "running."</li>
<li>on the right side is the assigned <a href="../cloud_glossary/#ip-address">IP address</a> which you need to connect.   Highlight and copy and paste this address.   If you click the link on the address, it will take you to a new resource page just for the IP address (which is a distinct resource assigned to this VM resource)</li>
</ul>
<h2 id="connecting">Connecting</h2>
<h3 id="connecting-to-a-windows-vm-using-remote-desktop-protocol-rdp-client">Connecting to a <strong>Windows</strong> VM using Remote Desktop Protocol (RDP) client</h3>
<p>You may connect to this VM running the Windows operating system with either graphical desktop, a command line connection, or both.  </p>
<p>The following Azure documentation describes how to connect to a Windows VM: <br />
<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/connect-logon">https://docs.microsoft.com/en-us/azure/virtual-machines/windows/connect-logon</a></p>
<p>Here are more detailed instructions: </p>
<p>There is a 'connect' link above the 'essentials' list, and a connect link on the left side - they both go to the same place. </p>
<p><strong>Connect with RDP</strong>  (remote desktop protocol)  is a Microsoft method for connecting to the graphical desktop.  For Mac/Linux requires additional software (mentioned at the beginning of this page).  </p>
<ul>
<li>Click "connect" and select "rdp" if it isn't already.  </li>
<li>click "<strong>download RDP file</strong>" button and save the <code>.rdp</code> file anywhere on your computer that you find it again</li>
<li>
<p>after it's download, and if you Mac users have installed the RDP client, then double click the <code>.rdp</code> file to open your remote desktop software. </p>
</li>
<li>
<p>On windows, any security or error messages, click "connect"</p>
</li>
<li>
<p>Alternatively you may also open your RPD software without downloading the RDP file, and copy the IP address listed on and paste the IP address that is listed on the resource page for the VM</p>
</li>
</ul>
<p><img alt="Entering an IP address into the Windows RDP client" src="../vm_activity/vm_activity_screenshot_remote_desktop_entering_ip_address.jpg" /></p>
<ul>
<li>When you connect, if the VM is not running, you will get an error message.  Here is what the Windows screen looks like: </li>
</ul>
<p><img alt="Windows remote desktop Certificate Warning" src="../vm_activity/vm_activity_screenshot_remote_desktop_cert_warning.jpg" /></p>
<p>This is because we are using a temporary certificate but it is secure.  Click "Yes" </p>
<ul>
<li>Enter the Username and password you used when  configuring the VM in the "Basics" section above.  <ul>
<li>you may be able to simply enter the user name and password directly</li>
<li>If not, in the  Windows Security window, select More choices and then Use a different account. Enter the credentials for an account on the virtual machine and then select OK.  If the user account you entered does not work, you may have to put your user account in domain\username form, and in this case, the domain is the name of the virtual machine and it is entered as vmname\username, with a back-slash in-between, and with the same password. </li>
</ul>
</li>
</ul>
<p>Once you connect, you may see Windows starting up and installing things.  Feel free to close any windows.  Once the installations are finished, you may use the machine as you would any other windows computer.  If you type Rstudio in the search box, you may launch an  Rstudio session on this remote computer.    It also has Python, many python libs and Jupyter notebook.  </p>
<p>We will cover how to transfer code and files to a VM in a later session. </p>
<p>When you finished with your remote session you may simply close the remote windows (leaving the VM running.  See below for how to turn it off and delete it. </p>
<p><strong>Optional: Connect to the Windows DSVM with ssh</strong>  </p>
<p>This windows machine has an SSH Server running, and the security settings from the pre-configured version allow connections from SSH.   If you are familiar with ssh and the command line, you may start the CMD.EXE on your windows computer, or the Mac Terminal, and enter
<code>ssh &lt;username&gt;@&lt;ipaddress&gt;</code></p>
<p>Where the username is the user you put for your VM when you created it, and the Public IP address is listed on the VM Resource page.   </p>
<p>This is similar to how you connect to the MSU HPC, if you are HPC user. </p>
<p>You will be asked to add the host to your list hosts, and enter the password you used when you created the VM. </p>
<p>When you log-in you will be connected to the Windows command prompt (e.g. <code>C:\Users\username&gt;</code> </p>
<p>To Exit, type <code>exit</code> at the command prompt. </p>
<p><strong>Next Steps:</strong> For information on turning off the VM and for eventually deleting the VM, scroll down below the Linux section as these operations are the same in the Azure portal for Linux or Windows virtual machines.  </p>
<h3 id="connecting-to-a-linux-vm-using-ssh">Connecting to a <strong>Linux</strong> VM using SSH</h3>
<p>We will connect and use this remote VM running the Linux operating system with a command line connection.  It is possible to use a graphical connection but requires additional setup beyond the scope of the short exercise.  </p>
<p>In addition this assumes you have some familiarity with using the command line and starting your terminal program.  </p>
<p>There is a 'connect' link above the 'essentials' list, and a connect link on the left side - they both go to the same place. </p>
<p><strong>Connect with SSH</strong>  </p>
<p>this is the standard method of connecting with ssh, but we've included as much detail as possible for those who are new to using ssh. </p>
<ul>
<li>On the main "overview" page of the VM resource, find the "Public IP Address" on the top right side.   Copy this IP address to the clipboard, or make a note of it.   Mine was 20.98.28.63.   Note that these VMS also have an internal IP address that start with 10.x.x.x that will not work for connecting from your laptop.  Use the Public IP address.  not all VMs <em>have</em> a public IP address but this one will.  </li>
<li>also make a note of the User ID and password you used to create the VM above</li>
<li>
<p>side note, in the "connect" form of the VM resource pages, it describes how to use an ssh key,  even though we did not create an ssh key when we created a VM.  If you did not create an ssh key, you do not need to follow these instructions. </p>
</li>
<li>
<p>on your desktop/laptop, start your terminal program on MacOS/Linux or <code>cmd.exe</code> if you using Windows. </p>
</li>
<li>Enter the command as displayed, which is something like <code>ssh vmusername@vmipaddress</code>   In my case, my command is <code>ssh patbills@20.98.28.63</code></li>
<li>If this is the first time connection, you'll get the standard ssh warning <code>"The authenticity of host '20.98.28.63 (20.98.28.63)' can't be established."</code> simply say "yes" and enter</li>
<li>Enter the password you used when  configuring the VM in the "Basics" section above.  (note that ssh does not show any key movement or * when you type a password)</li>
<li>it takes a while to connect for the fist time as the VM configures software and prepares your user account</li>
</ul>
<p>You may use the machine as you would any other linux computer. For more information about what software is installed, see 
We will cover how to transfer code and files to a VM in a later session. </p>
<p>When you finished with your remote session you may simply close the remote windows (leaving the VM running.  See below for how to turn it off and delete it. </p>
<p><strong>Optional: Connect to the Windows DSVM with ssh</strong>  </p>
<p>This windows machine has an SSH Server running, and the security settings from the pre-configured version allow connections from SSH.   If you are familiar with ssh and the command line, you may start the CMD.EXE on your windows computer, or the Mac Terminal, and enter
<code>ssh &lt;username&gt;@&lt;ipaddress&gt;</code></p>
<p>Where the username is the user you put for your VM when you created it, and the Public IP address is listed on the VM Resource page.   </p>
<p>This is similar to how you connect to the MSU HPC, if you are HPC user. </p>
<p>You will be asked to add the host to your list hosts, and enter the password you used when you created the VM. </p>
<p>When you log-in you will be connected to the Windows command prompt (e.g. <code>C:\Users\username&gt;</code> </p>
<p>To Exit, type <code>exit</code> at the command prompt. </p>
<h2 id="starting-and-stopping-the-vm-both-windows-and-linux">Starting and Stopping the VM (both Windows and Linux)</h2>
<p>There are three ways to "stop" or turn off a VM.<br />
1. when connected to it, e.g. in the remote desktop, use  Windows to turn it off.  The VM is then "stopped."   In a Linux ssh session you may use a command like <code>sudo shutdown -h now</code>   When the Operating system is shut off, and hence tthe VM is not running, but it is still "allocated."  When you turn it back on, it will come on immediately. 
1. Use the Azure portal to "stop" the VM which shuts down Windows (gracefully if possible) and 'deallocates' the VM.  Restarted the VM appears to be the same process, but Azure must allocate resources first to run it, then power it up.  This is cheaper then the first method in the long run
1. Delete it.   </p>
<h3 id="stopping-deallocating-the-vm-with-the-portal">Stopping (deallocating) the VM with the Portal:</h3>
<ol>
<li>Go to the resource page for the VM, if you are not already. </li>
<li>If you are just entering the portal, find your resource group, find the VM in your resource group (identified as a VM in the "type" column of the list of resources), and click to open the resource page. </li>
<li>The Status field near the top of this screen will indicate running or stopped.  </li>
<li>Find the Start and Stop buttons near the top of this screen and click "stop" if the machine is running. </li>
<li>There is a warning about losing your IP address, with a check box to reserve it.<ul>
<li>If you plan on deleting the VM now, click "ok"</li>
<li>If you plan on restarting the VM and reconnecting, first check the box "reserve the IP" then click OK</li>
<li>The default is to use a "dynamic" address which is assigned every time you turn on the VM</li>
<li>When using a dynamic address, you must copy/paste the ip address, or re-download the RDP connection file everytime you restart the machine</li>
<li>the solution is to use a "Static IP" either when you create the VM, or assigning one after the VM is created. and checking the box does so. </li>
<li>you can also convert to a static IP with the portal, but it is not a straightforward process, see <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-static-private-ip-arm-pportal">https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-static-private-ip-arm-pportal</a></li>
<li>Pricing for a static ip is here: <a href="https://azure.microsoft.com/en-us/pricing/details/ip-addresses/">https://azure.microsoft.com/en-us/pricing/details/ip-addresses/</a> which as of now is $0.0036/hour which is charged even if the VM is turned off.  That is approx $2.70/month</li>
</ul>
</li>
<li>It's a good idea to leave VMs in a "stopped (deallocated)" state if you are not using them for computations or providing a service, just as you would turn off or put your laptop to sleep.   The main reason for this is for security.  </li>
</ol>
<h2 id="deleting-the-resources-both-windows-and-linux">Deleting the Resources (both Windows and Linux)</h2>
<ol>
<li>Open the Resource group as above</li>
<li>When creating resources using the template as we did above, the resources associated with this VM will all start with the same prefix, so they are easy to identify.   Select them with checkboxes, and click the "Delete" button which is on the top right of the screen (not the "delete resource group" button)</li>
<li>If it's not obvious which resources are all included, you may also use the "tag" you created to filter what is listed and only show those with the same "tag."  For more information see <a href="https://docs.microsoft.com/en-us/azure/azure-portal/manage-filter-resource-views">https://docs.microsoft.com/en-us/azure/azure-portal/manage-filter-resource-views</a> .  If you add filter on tag, then you may select all the items that are shown, and delete those. </li>
<li>after selecting confirm the deletion by typing "yes"</li>
</ol>
<p>Creating resources just to delete them may seem wasteful however we will cover how to save a "snapshot" and/or "image" of your VM's disk so that you may re-use any work to install and configure software withtout incurring charges.  </p>
<h2 id="more-refereences">More Refereences</h2>
<p>Azure has very abbreviated versions of this exercise if you would like another perspective.  They assume you can create your own resource group (which you don't have the ability to do currently in the fellowship)  </p>
<p><a href="https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/overview#next-steps">https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/overview#next-steps</a>  </p>
<p><strong>Data Science Use Case Tutorials from Azure: </strong></p>
<ul>
<li>
<p>Windows: This tutorial uses products that Azure no long supports, and for Windows users they really push to use their "Azure Machine Learning" product.   However the Windows DSVM offers a really fast way to get access to a windows desktop graphical interface  <a href="https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/vm-do-ten-things">https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/vm-do-ten-things</a> </p>
</li>
<li>
<p>Linux: <a href="https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/linux-dsvm-walkthrough">https://docs.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/linux-dsvm-walkthrough</a></p>
</li>
</ul>
<p>If you follow these, just remember to delete the resources you create when you are done exploring</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.febc23d1.min.js"></script>
      
    
  </body>
</html>